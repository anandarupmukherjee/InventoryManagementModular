{% load custom_tags %}
{% load static %}
{% load feature_flags %}

<!DOCTYPE html>
<html>
<head>
    <title>Export Data</title>
    <link rel="stylesheet" href="{% static 'inventory/styles.css' %}">
    <script src="{% static 'inventory/report_preview.js' %}" defer></script>

</head>
<body>

    <!-- Navigation Bar -->
    {% include "includes/navbar.html" %}


  <div class="dashboard-container form-v2 w-80">
    <div class="card form-card">
      <div class="form-body">
        <h2>Export Data from Inventory System</h2>

        <form method="get" id="downloadForm" class="form-v2-form">
          <div class="form-grid">
            <div class="form-row">
              <label for="modelSelect">Select Model:</label>
              <select name="model" id="modelSelect">
                {% for model_value, model_label in model_options %}
                  <option value="{{ model_value }}" {% if model_value == selected_model %}selected{% endif %}>{{ model_label }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="form-row">
              <label for="start_date">Start Date:</label>
              <input type="date" id="start_date" name="start_date" value="{{ start_date }}">
            </div>
            <div class="form-row">
              <label for="end_date">End Date:</label>
              <input type="date" id="end_date" name="end_date" value="{{ end_date }}">
            </div>
          </div>
          <div class="form-actions-sticky">
            <button type="submit" name="download" value="excel" class="btn btn-primary">Download Excel</button>
            <button type="submit" name="download" value="csv" class="btn btn-secondary">Download CSV</button>
          </div>
        </form>
      </div>
    </div>

      <div class="card table-card">
        <h3>Preview: {{ selected_model_label }}</h3>
        <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              {% for field in fields %}
                <th>{{ field }}</th>
              {% endfor %}
            </tr>
          </thead>
          <tbody>
            {% for obj in data %}
              <tr>
                {% for field in fields %}
                  <td>{{ obj|attr:field }}</td>
                {% endfor %}
              </tr>
            {% endfor %}
          </tbody>
        </table>
        </div>
      </div>
   
      
    </div>
</body>
</html>
